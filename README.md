# Описание уязвимости
CSRF (Cross-Site Request Forgery) — это атака, при которой злоумышленник заставляет аутентифицированного пользователя выполнить нежелательные действия на веб-странице. При этом законный пользователь не знает об этом. CSRF-атака возможна, если веб-приложение не проверяет подлинность запроса, отправленного на сервер. Если браузер автоматически добавляет куки сессии при выполнении запроса, злоумышленник может подменить данные.

# Способы защиты
1. Использование CSRF-токенов
2. Проверка заголовков "Origin" и "Referer"
3. Ограничение методов запроса (GET-запрос не должен изменять данные)
4. Ограничение времени жизни сессий
5. Использование SameSite Cookies

# Запуск приложения
Для запуска необходимо запустить Docker и прописать в командной строке:

*docker-compose up --build*

# Описание уязвимости в реализованном приложении
В приложении реализована защита от CSRF с использованием SameSite cookies со значением *Lax*. Однако, такая защита не позволяет блокировать GET-запросы. Это позволяет злоумышленнику произвести атаку: с помощью GET-запроса (в виде автоматически кликающейся ссылки) на страницу смены пароля поменять пароль админа на любой иной, залогиниться от его имени и получить флаг.

# POC-эксплоит для получения флага
После запуска приложения начинает свою работу чекер. Он авторизуется на странице логина (**http://web:5000/login**) как администратор ("admin/admin123").Чекер переходит на вредоносную страницу (**http://evil:5005/login**) - злоумышленник мог хитростью заставить администратора зайти туда - и через 1 секунду автоматически выполняет GET-запрос на страницу смены пароля с заданным паролем (hacked123). Так как это навигационный запрос (переход по ссылке), cookies отправляются, несмотря на использование SameSite=Lax, и пароль администратора действительно меняется. Наконец, чекер заходит через страницу логина с новоустановленным паролем, и флаг отображается.

Пример логов чекера:

*Checker script started*

*Checking...*

*Starting check...*

*Opening login page: http://web:5000/login*

*Redirected to: http://web:5000/welcome*

*Opening attacker page: http://evil:5005/login*

*Page loaded successfully*

*Re-opening login page: http://web:5000/login*

*CSRF exploit worked! ✅*

После того, как последняя строка будет иметь место, можно зайти на страницу логина (**http://localhost:5000/login**, а НЕ **http://web:5000/login** - т.к. мы находимся вне контейнера), выполнить вход ("admin/hacked123") и увидеть флаг.
